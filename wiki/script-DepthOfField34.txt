! Depth of Field 3.4

$$Depth of Field$$は、カメラレンズの特性をシミュレートした、一般的なエフェクトです。名前は効果がUnity 3.4で追加されたという事実を指しますが、この機能は[[script-DepthOfFieldScatter | Depth Of Field Scatter]] により取って代わられており、新機能は近代的かつ洗練されていて、最適化された映像テクニックを用いてレンズBlur（ぼかし）をシミュレートし、焦点領域間の移行がスムーズになっています。しかし、使用する状況もよるが、もともと古いハードウェアのために開発さた機能であるためにパフォーマンスは旧3.4バージョンの方が大分良いかもしれません。

現実世界では、カメラから一定距離の被写体のみに鋭く焦点を当てることができ、カメラから近いまたは遠いオブジェクトは焦点がずれます。ぼかしはオブジェクトの距離に関する視覚的な手掛かりを与えるだけでなく、``Bokeh``（ボケ）という用語は、画像の明るい部分の周りに焦点からずれて魅力的に表現される視覚的な画像の乱れのことです。

Depth of Fieldの例を次の画像で見ますが、焦点の当たった前景と焦点を外した背景が表示されています。前景のBlur（ぼかし）が他の領域と重なる一方で、背景は重なっていないことに注目してください。

Attach:ImageEffects./DofExample1.png\\
近くパイプだけが焦点の当たる領域にある

Attach:ImageEffects./DofExample2.png\\
Depto of Fieldを用いて、前景と背景のBlur（ぼかし）比較

[[script-TiltShift|Tilt Shift effect]] を用いることで、もっとストレートでそこまで洗練はされていないDepth of Fieldエフェクトを得ることも、検討の余地があります。

その他の [[comp-ImageEffects|image effects]] 同様、この効果は Unity Pro 専用です。 必ず、[[HOWTO-InstallStandardAssets|Pro Standard Assets]] をインストールしてください。

!! プロパティ
||PROPS
||``General Settings`` ||||
||``Resolution`` ||内部的なレンダリング　ターゲットサイズを決定します。低い解像度では、高速なレンダリングとなり、メモリ要求も少なくなります。||
||``Quality`` ||品質レベル。より処理が速い``OnlyBackground``か、　より品質が高い``BackgroundAndForeground``でDepth of Fieldをそれぞれの領域で別計算するか、のいずれかを選択してください。||
||``Simple tweak`` ||シンプルな焦点のモデルに切り替えます。||
||``Visualize focus`` ||学習やデバッグ支援のため、ゲームビューで指定する焦点を当てる領域を示しています。||
||``Enable bokeh`` ||現実世界に近いレンズBlur（ぼかし）が生成され、非常に明るい部分がスケールされ重ね合わせされる。||

||``Focal Settings`` ||||
||``Focal distance`` ||ワールド空間でのカメラ位置から焦点面までの距離。||
||``Object Focus`` ||シーンでターゲットオブジェクトを使用してFocal distanceを決定します。||||
||``Smoothness`` ||焦点の当たらない領域から焦点のあたる領域へ移行する滑らかさ。||
||``Focal Size`` ||焦点のあたる領域のサイズ。||||

||``Blur`` ||||
||``Blurriness`` ||さまざまなバッファをBlur（ぼかし）する際の反復回数（反復ごとに処理時間を消費します）。||
||``Blur spread`` ||Blur（ぼかし）の半径。これは解像度に依存しないため、必要な解像度ごとに値を調整する必要があるかもしれません。||

||``Bokeh Settings`` ||||
||``Destination`` ||前景と背景のBlur（ぼかし）を有効にすると、レンダリング時間が増加しますが、より現実的な結果が得られます。||
||``Intensity`` ||Bokeh（ボケ）形状が収集するにあたり、使用するブレンド強度。常に慎重に調整する必要がある重要な値です。||
||``Min luminance`` ||輝度のしきい値で、この値以下のピクセルにはBokeh（ボケ）が適用されません。||
||``Min contrast`` ||コントラストのしきい値、それ以下のピクセルにはBokeh（ボケ）が適用されません。ここで重要なことは、通常だけ高周波の領域（すなわち、雑然としたり、うるさく感じる画像の領域）でのみBokeh（ボケ）形状が必要であるということです。不要なBokeh（ボケ）トの生成を避けるために、このパラメータを調整するとパフォーマンスが向上します。||
||``Downsample`` ||Bokeh（ボケ）形状が収集するにあたり、使用する内部的なレンダリング　ターゲットサイズ。||
||``Size`` ||Bokeh（ボケ）の最大サイズ。焦点の当たらない領域の量（錯乱円）で調整されます。||
||``Bokeh Texture`` ||Bokeh（ボケ）形状を定義するテクスチャ。||

Bokeh（ぼけ）エフェクトはピクセルごとに三角形を描画することにより作成されるので、最適に調整されていない場合はフレームレートに大きな影響を与える可能性があることに注意してください。Adjust the ``Size``、``Min luminance``、``Min contrast``、``Downsample``および``Resolution``を調整してパファオーマンスを向上させます。Bokeh（ボケ）形状が適用される前に画面を暗くしているので、画像の乱れを除去するために適切な``Blurriness``を設定する必要があります。

(:include imagefx-SM3Depth:)
